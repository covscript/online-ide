<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Covariant Script Online IDE</title>
</head>

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script>
    function onRun() {
        var code = document.getElementById("code").value
        var stdin = document.getElementById("stdin").value
        document.getElementById("result").value = ""

        var ecode = window.btoa(code)
        var estdin = window.btoa(stdin)

        $.ajax({
            type: "post",
            url: "http://dev.covariant.cn/cgi/cs-online",
            data: JSON.stringify({code: ecode, stdin: estdin}),
            async: true,
            success: function (data) {
                document.getElementById("result").value = data
            },
            error: function (data) {
                document.getElementById("result").value = "Error: " + data
            }
        });
    }

    function onReset() {
	    document.getElementById("result").value = ""
        document.getElementById("code").value =
            "import streams\n" +
            "\n" +
            "@begin\n\n" +
            "streams.iterate(1, [](x) -> x * 2)\n" +
            "       .filter([](x) -> x > 100000)\n" +
            "       .skip(5)\n" +
            "       .take_while([](x) -> x <= 5000000)\n" +
            "       .for_each(system.out.println)\n" +
            "\n" +
            "@end\n"
    }

</script>

<style>
#main  {float:left; border:1px;height:100%;width:100%;}
#left  {float:left; border:1px;height:100%;width:48%; }
#right {float:right;border:1px;height:100%;width:48%; }
.comments {
    width:100%;
    overflow:auto;
    word-break:break-all;
    font-family:monospace;
}

</style>

<body>
<div id="main">
    <div id="left">
        <p>代码</p>
        <textarea class="comments" name="code" id="code" rows="20" autofocus="true"
                  style="resize: none; font-size: large;"></textarea>
        <button class="comments" style="font-size: large;height: 4.6%;" type="submit" onclick="onRun()">运行</button>
        <button class="comments" style="font-size: large;height: 4.6%;" type="clear" onclick="onReset()">重置</button>
    </div>
    <div id="right">
        <p>输入</p>
        <textarea class="comments" name="stdin" id="stdin" rows="10"
                  style="resize: none; font-size: large;"></textarea>
        <p>输出</p>
        <textarea class="comments" name="result" id="result" rows="10" readonly="true"
                  style="resize: none; font-size: large;"></textarea>
    </div>
</div>
</body>

<script>
	onReset()

</script>
</html>

